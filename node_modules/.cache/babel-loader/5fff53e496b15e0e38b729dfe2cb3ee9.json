{"ast":null,"code":"import _toConsumableArray from\"/Users/altafquadri/Development/code/Mod5Project/Frontend/lead-us-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"/Users/altafquadri/Development/code/Mod5Project/Frontend/lead-us-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/altafquadri/Development/code/Mod5Project/Frontend/lead-us-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/altafquadri/Development/code/Mod5Project/Frontend/lead-us-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _possibleConstructorReturn from\"/Users/altafquadri/Development/code/Mod5Project/Frontend/lead-us-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";import _getPrototypeOf from\"/Users/altafquadri/Development/code/Mod5Project/Frontend/lead-us-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";import _inherits from\"/Users/altafquadri/Development/code/Mod5Project/Frontend/lead-us-react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import React from'react';import Navbar from'./components/Navbar';import MainContainer from'./containers/MainContainer';import NewLeadContainer from'./containers/NewLeadContainer';import LeadActivityContainer from'./containers/LeadActivityContainer';import SignupForm from'./components/SignupForm';import LoginForm from'./components/LoginForm';import Profile from'./containers/Profile';import MetricsContainer from'./containers/MetricsContainer';import'./App.css';import{Switch,Route,withRouter}from\"react-router-dom\";// const api = 'http://localhost:3000/api/v1/auto_login'\nvar api='https://lead-us-backend.herokuapp.com/api/v1/auto_login';var App=/*#__PURE__*/function(_React$Component){_inherits(App,_React$Component);function App(){var _getPrototypeOf2;var _this;_classCallCheck(this,App);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_possibleConstructorReturn(this,(_getPrototypeOf2=_getPrototypeOf(App)).call.apply(_getPrototypeOf2,[this].concat(args)));_this.state={currentUser:null,leads:[],calls:[],appointments:[],clickedLead:[],clickedLeadCalls:[],clickedLeadAppointments:[],archived:[],appointmentSales:[],sales:[],pastClients:[],loading:true};_this.setCurrentUser=function(user){_this.setState({currentUser:user,leads:user.leads.filter(function(leads){return!leads['lead_archived?']&&!leads['sale_made?'];}),archived:user.leads.filter(function(leads){return leads['lead_archived?'];}),pastClients:user.leads.filter(function(leads){return leads['sale_made?'];}),calls:user.calls,/* had to write a different filter for appointments when a lead is archived\n      taking all leads and filtering them for archived leads, mapping their ids\n      to check that appointment with an archived lead id is not included among them\n      */appointments:user.appointments.filter(function(appointment){return!user.leads.filter(function(leads){return leads['lead_archived?'];}).map(function(archiveLead){return archiveLead.id;}).includes(appointment.lead_id);}),appointmentSales:user.appointments.filter(function(appointments){return appointments['made_sale?'];}),sales:user.sales},function(){localStorage.user_id=user.id;_this.props.history.push('/');});};_this.logoutUser=function(){_this.setState({currentUser:null},function(){localStorage.removeItem('user_id');localStorage.clear();_this.props.history.push('/login');});};_this.findLeadName=function(id){if(id===undefined)return;var name,lead;var found=_this.state.leads.find(function(lead){return lead.id===id;});found?lead=_this.state.leads.find(function(lead){return lead.id===id;}):!found?lead=_this.state.pastClients.find(function(lead){return lead.id===id;}):lead=_this.state.archived.find(lead.id===id);if(!lead)return;name=\"\".concat(lead.first_name,\" \").concat(lead.last_name);return name;};_this.onLeadClick=function(leadData){if(leadData.lead.id===undefined)return;//not sure i need this condition, bc setstate was wrong for archive lead\n_this.setState({clickedLead:leadData.lead,clickedLeadCalls:_this.state.calls.filter(function(calls){return calls.lead_id===leadData.lead.id;}),clickedLeadAppointments:_this.state.appointments.filter(function(appointments){return appointments.lead_id===leadData.lead.id;})},function(){_this.props.history.push(\"/leads/\".concat(leadData.lead.id));});};_this.addNewLead=function(newLead){_this.setState(_objectSpread({},_this.state,{leads:[].concat(_toConsumableArray(_this.state.leads),[newLead])}));};_this.archiveLead=function(lead){_this.setState(_objectSpread({},_this.state,{leads:_toConsumableArray(_this.state.leads.filter(function(stateLead){return stateLead.id!==lead.id;})),archived:[].concat(_toConsumableArray(_this.state.archived),[lead])}),function(){return _this.setState({appointments:_toConsumableArray(_this.state.appointments.filter(function(appointment){return!_this.state.archived.map(function(archiveLead){return archiveLead.id;}).includes(appointment.lead_id);}))});});};_this.addNewCall=function(newCall){_this.setState(_objectSpread({},_this.state,{calls:[].concat(_toConsumableArray(_this.state.calls),[newCall]),clickedLeadCalls:[].concat(_toConsumableArray(_this.state.clickedLeadCalls),[newCall])}));};_this.addNewAppointment=function(newAppointment){_this.setState(_objectSpread({},_this.state,{appointments:[].concat(_toConsumableArray(_this.state.appointments),[newAppointment]),clickedLeadAppointments:[].concat(_toConsumableArray(_this.state.clickedLeadAppointments),[newAppointment])}));};_this.editTheAppointment=function(appointment){_this.setState(_objectSpread({},_this.state,{appointments:_toConsumableArray(_this.state.appointments.map(function(stateAppointment){if(stateAppointment.id===appointment.id){return appointment;}else{return stateAppointment;}})),clickedLeadAppointments:_toConsumableArray(_this.state.clickedLeadAppointments.map(function(stateAppointment){if(stateAppointment.id===appointment.id){return appointment;}else{return stateAppointment;}}))}),function(){return _this.setState(_objectSpread({},_this.state,{// appointments: [...this.state.appointments.filter(appointments => !appointments['made_sale?'])],\nappointmentSales:_toConsumableArray(_this.state.appointments.filter(function(appointments){return appointments['made_sale?'];}))}));});};_this.editCallNoApp=function(call){_this.setState(_objectSpread({},_this.state,{calls:_toConsumableArray(_this.state.calls.map(function(stateCall){if(stateCall.id===call.id){return call;}else{return stateCall;}})),clickedLeadCalls:_toConsumableArray(_this.state.clickedLeadCalls.map(function(stateCall){if(stateCall.id===call.id){return call;}else{return stateCall;}}))}));};_this.addSale=function(sale){_this.setState(_objectSpread({},_this.state,{sales:[].concat(_toConsumableArray(_this.state.sales),[sale]),leads:_toConsumableArray(_this.state.leads.filter(function(leads){return!leads['sale_made?'];}))}));};_this.addPastClient=function(lead){_this.setState({pastClients:[].concat(_toConsumableArray(_this.state.pastClients),[lead]),leads:_toConsumableArray(_this.state.leads.filter(function(stateLeads){return stateLeads.id!==lead.id;}))});};return _this;}_createClass(App,[{key:\"componentDidMount\",//End of Functions written to add lead activity ***********************************************************************************\nvalue:function componentDidMount(){var _this2=this;//setup for auto_login\nvar user_id=localStorage.user_id;if(user_id){fetch(api,{headers:{\"Authorization\":user_id}}).then(function(res){return res.json();}).then(function(user){return _this2.setCurrentUser(user);});}this.setState({loading:false,clickedLead:[],clickedLeadCalls:[],clickedLeadAppointments:[],appointments:_toConsumableArray(this.state.appointments.filter(function(appointment){return!_this2.state.archived.map(function(archiveLead){return archiveLead.id;}).includes(appointment.lead_id);}))});}},{key:\"render\",value:function render(){var _this3=this;if(this.state.loading){return React.createElement(\"h1\",null,\"Loading...\");}return React.createElement(\"div\",{className:\"main-page-container\"},React.createElement(Navbar,{currentUser:this.state.currentUser,logoutUser:this.logoutUser}),React.createElement(Switch,null,React.createElement(Route,{path:\"/leads/:id\",render:function render(routerProps){return React.createElement(LeadActivityContainer,Object.assign({currentUser:_this3.state.currentUser,lead:_this3.state.clickedLead,calls:_this3.state.clickedLeadCalls,clickedLeadAppointments:_this3.state.clickedLeadAppointments,addNewCall:_this3.addNewCall,addNewAppointment:_this3.addNewAppointment,editCallNoApp:_this3.editCallNoApp,editTheAppointment:_this3.editTheAppointment,addSale:_this3.addSale,archiveLead:_this3.archiveLead,addPastClient:_this3.addPastClient},routerProps));}}),React.createElement(Route,{path:\"/profile\",render:function render(routerProps){return React.createElement(Profile,Object.assign({},routerProps,{currentUser:_this3.state.currentUser,pastClients:_this3.state.pastClients,archived:_this3.state.archived}));}}),React.createElement(Route,{path:\"/metrics\",render:function render(routerProps){return React.createElement(MetricsContainer,Object.assign({},routerProps,{currentUser:_this3.state.currentUser,sales:_this3.state.sales,appointments:_this3.state.appointments}));}}),React.createElement(Route,{path:\"/new\",render:function render(routerProps){return React.createElement(NewLeadContainer,Object.assign({currentUser:_this3.state.currentUser,addNewLead:_this3.addNewLead},routerProps));}}),React.createElement(Route,{path:\"/signup\",render:function render(routerProps){return React.createElement(SignupForm,Object.assign({},routerProps,{setCurrentUser:_this3.setCurrentUser}));}}),React.createElement(Route,{path:\"/login\",render:function render(routerProps){return React.createElement(LoginForm,Object.assign({},routerProps,{setCurrentUser:_this3.setCurrentUser}));}}),React.createElement(Route,{exact:true,path:\"/\",render:function render(routerProps){return React.createElement(MainContainer,Object.assign({leads:_this3.state.leads,onLeadClick:_this3.onLeadClick,currentUser:_this3.state.currentUser,appointments:_this3.state.appointments,findLeadName:_this3.findLeadName},routerProps));}})));}}]);return App;}(React.Component);export default withRouter(App);","map":{"version":3,"sources":["/Users/altafquadri/Development/code/Mod5Project/Frontend/lead-us-react/src/App.js"],"names":["React","Navbar","MainContainer","NewLeadContainer","LeadActivityContainer","SignupForm","LoginForm","Profile","MetricsContainer","Switch","Route","withRouter","api","App","state","currentUser","leads","calls","appointments","clickedLead","clickedLeadCalls","clickedLeadAppointments","archived","appointmentSales","sales","pastClients","loading","setCurrentUser","user","setState","filter","appointment","map","archiveLead","id","includes","lead_id","localStorage","user_id","props","history","push","logoutUser","removeItem","clear","findLeadName","undefined","name","lead","found","find","first_name","last_name","onLeadClick","leadData","addNewLead","newLead","stateLead","addNewCall","newCall","addNewAppointment","newAppointment","editTheAppointment","stateAppointment","editCallNoApp","call","stateCall","addSale","sale","addPastClient","stateLeads","fetch","headers","then","res","json","routerProps","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport Navbar from './components/Navbar'\nimport MainContainer from './containers/MainContainer';\nimport NewLeadContainer from './containers/NewLeadContainer';\nimport LeadActivityContainer from './containers/LeadActivityContainer';\nimport SignupForm from './components/SignupForm';\nimport LoginForm from './components/LoginForm';\nimport Profile from './containers/Profile'\nimport MetricsContainer from './containers/MetricsContainer'\nimport './App.css'\n\nimport {Switch, Route, withRouter } from \"react-router-dom\";\n\n// const api = 'http://localhost:3000/api/v1/auto_login'\nconst api = 'https://lead-us-backend.herokuapp.com/api/v1/auto_login'\n\nclass App extends React.Component {\n\n  state = { \n    currentUser: null,\n    leads: [],\n    calls: [],\n    appointments: [],\n    clickedLead: [],\n    clickedLeadCalls: [],\n    clickedLeadAppointments: [],\n    archived: [],\n    appointmentSales: [],\n    sales: [],\n    pastClients: [],\n    loading: true\n}\n\n\nsetCurrentUser = (user) => {\n  this.setState(\n    { \n      currentUser: user,\n      leads: user.leads.filter(leads => !leads['lead_archived?'] && !leads['sale_made?']),\n      archived: user.leads.filter(leads => leads['lead_archived?']),\n      pastClients: user.leads.filter(leads => leads['sale_made?']),\n      calls: user.calls,\n\n      /* had to write a different filter for appointments when a lead is archived\n      taking all leads and filtering them for archived leads, mapping their ids\n      to check that appointment with an archived lead id is not included among them\n      */\n      appointments: user.appointments\n        .filter(appointment => (!(user.leads.filter(leads => leads['lead_archived?'])\n        .map(archiveLead => archiveLead.id)).includes(appointment.lead_id))), \n      \n        appointmentSales: user.appointments.filter(appointments => appointments['made_sale?']),\n      sales: user.sales\n    }, () => {\n      localStorage.user_id = user.id\n      this.props.history.push('/')\n    })\n}\n\nlogoutUser = () => {\n  this.setState({ currentUser: null  }, () => {\n    localStorage.removeItem('user_id')\n    localStorage.clear()\n    this.props.history.push('/login')\n  })\n}\n\n//Functions written to add lead activity ***************************************************************************************\n\nfindLeadName = (id) => {\n  if (id === undefined) return\n  let name, lead\n  let found = this.state.leads.find(lead => lead.id === id)\n  found ? lead = this.state.leads.find(lead => lead.id === id)\n    : !found ? lead = this.state.pastClients.find(lead => lead.id === id)\n    : lead = this.state.archived.find(lead.id === id)\n\n  if (!lead) return\n  name = `${lead.first_name} ${lead.last_name}`\n  return name\n}\n\n//to point us to the lead show page\n  onLeadClick = (leadData) => {\n\n    if (leadData.lead.id === undefined) return  //not sure i need this condition, bc setstate was wrong for archive lead\n    this.setState(\n      { \n        clickedLead: leadData.lead,\n        clickedLeadCalls: this.state.calls.filter(calls => calls.lead_id === leadData.lead.id), \n        clickedLeadAppointments: this.state.appointments.filter(appointments => appointments.lead_id === leadData.lead.id)\n      }, () => {\n      this.props.history.push(`/leads/${leadData.lead.id}`)\n    }) \n  }\n  //triggered by new lead form\n  addNewLead = (newLead) => {\n    this.setState (\n      {\n        ...this.state, \n        leads:  [...this.state.leads, newLead]\n        \n      }) \n  }\n\n  archiveLead = (lead) => {\n    this.setState(\n      {\n        ...this.state,\n        leads: [...this.state.leads.filter(stateLead => stateLead.id !== lead.id )],\n        archived: [...this.state.archived, lead] \n      }, () => this.setState(\n        { \n          appointments: [...this.state.appointments.filter(appointment => (!(this.state.archived.map(archiveLead => archiveLead.id)).includes(appointment.lead_id)))] \n        }))\n  }\n\n\n\n\n  //triggered by user clicking on the phone number\n  addNewCall = (newCall) => {\n  this.setState(\n    {\n      ...this.state,\n      calls: [...this.state.calls, newCall],\n      clickedLeadCalls: [...this.state.clickedLeadCalls, newCall]  \n    });\n  }\n\n  addNewAppointment = (newAppointment) => {\n  this.setState(\n    {\n      ...this.state,\n      appointments: [...this.state.appointments, newAppointment],\n      clickedLeadAppointments: [...this.state.clickedLeadAppointments, newAppointment]  \n    });\n  }\n\n  editTheAppointment = (appointment) => {\n    this.setState(\n      { \n        ...this.state,\n        appointments: [...this.state.appointments.map(stateAppointment => {\n          if (stateAppointment.id === appointment.id) {\n            return appointment\n          } else {\n            return stateAppointment\n          }\n        })],\n        clickedLeadAppointments: [...this.state.clickedLeadAppointments.map(stateAppointment => {\n          if (stateAppointment.id === appointment.id) {\n            return appointment\n          } else {\n            return stateAppointment\n          }\n        })]\n      }, () => this.setState(\n        { \n          ...this.state,\n          // appointments: [...this.state.appointments.filter(appointments => !appointments['made_sale?'])],\n          appointmentSales: [...this.state.appointments.filter(appointments => appointments['made_sale?'])]  \n        }))\n  }\n\n  //written for the cancel button on appointment form\n  editCallNoApp = (call) => {\n    this.setState(\n      { \n        ...this.state,\n        calls: [...this.state.calls.map(stateCall => {\n            if (stateCall.id === call.id) {\n              return call\n            } else {\n              return stateCall\n            }\n        })],  \n        clickedLeadCalls: [...this.state.clickedLeadCalls.map(stateCall => {\n          if (stateCall.id === call.id) {\n            return call\n          } else {\n            return stateCall\n          }\n      })]\n    });\n  }\n\n  addSale = (sale) => {\n    this.setState(\n      { \n        ...this.state,\n        sales: [...this.state.sales, sale],\n        leads: [...this.state.leads.filter(leads => !leads['sale_made?'])] \n      })\n  }\n\n  addPastClient = (lead) => {\n    this.setState(\n      {   \n        pastClients: [...this.state.pastClients, lead],\n        leads: [...this.state.leads.filter(stateLeads => stateLeads.id !== lead.id)]\n      })\n  }\n\n //End of Functions written to add lead activity ***********************************************************************************\n\ncomponentDidMount() {\n  //setup for auto_login\n\n  const user_id = localStorage.user_id\n  if (user_id) {\n    \n    fetch(api, {\n      headers: {\n        \"Authorization\": user_id\n      }\n    }).then(res => res.json()).then(user => this.setCurrentUser(user))\n  }\n  this.setState(\n    { \n      loading: false, \n      clickedLead: [],\n      clickedLeadCalls: [],\n      clickedLeadAppointments: [],\n      appointments: [...this.state.appointments.filter(appointment => (!(this.state.archived.map(archiveLead => archiveLead.id)).includes(appointment.lead_id)))]\n    })\n\n  \n    \n}\n\n  render() {\n    if (this.state.loading) {\n      return <h1>Loading...</h1>\n    }\n\n    return (\n      <div className=\"main-page-container\">\n              <Navbar currentUser={this.state.currentUser} logoutUser={this.logoutUser}/>\n\n              <Switch>\n              \n                <Route path=\"/leads/:id\" render={(routerProps) => <LeadActivityContainer \n                currentUser={this.state.currentUser}\n                lead={this.state.clickedLead}\n                calls={this.state.clickedLeadCalls}\n                clickedLeadAppointments={this.state.clickedLeadAppointments}\n                addNewCall={this.addNewCall}\n                addNewAppointment={this.addNewAppointment}\n                editCallNoApp={this.editCallNoApp}\n                editTheAppointment={this.editTheAppointment}\n                addSale={this.addSale}\n                archiveLead={this.archiveLead}\n                addPastClient={this.addPastClient}\n                {...routerProps}/> }></Route>\n\n                <Route path=\"/profile\" render={(routerProps) => \n                <Profile {...routerProps} \n                currentUser={this.state.currentUser}\n                pastClients={this.state.pastClients}\n                archived={this.state.archived}/>}></Route>\n\n\n                <Route path=\"/metrics\" render={(routerProps) => <MetricsContainer\n                  {...routerProps} \n                  currentUser={this.state.currentUser}\n                  sales={this.state.sales}\n                  appointments={this.state.appointments}/>}></Route>\n\n                <Route path=\"/new\" render={(routerProps) => <NewLeadContainer\n                currentUser={this.state.currentUser} \n                addNewLead={this.addNewLead} \n                {...routerProps}/>}></Route> \n\n                <Route path=\"/signup\" render={(routerProps) => <SignupForm {...routerProps} setCurrentUser={this.setCurrentUser}/>}></Route>\n\n                <Route path=\"/login\" render={(routerProps) => <LoginForm {...routerProps} setCurrentUser={this.setCurrentUser}/>}></Route>\n\n                <Route exact path=\"/\" render={(routerProps) =>  <MainContainer \n                leads={this.state.leads} onLeadClick={this.onLeadClick} currentUser={this.state.currentUser}\n                appointments={this.state.appointments} findLeadName={this.findLeadName}\n                {...routerProps}/>}></Route>\n\n              </Switch>\n            </div>\n    );\n  }\n}\n\nexport default withRouter(App);\n"]},"metadata":{},"sourceType":"module"}