{"ast":null,"code":"import utils from '../utils';\nimport template from 'lodash.template';\nimport isEqual from 'lodash.isequal';\n\nlet fs = require('fs'); // substack/brfs#39\n\n\nlet instructionsTemplate = template(fs.readFileSync(__dirname + '/../templates/instructions.html', 'utf8'));\nlet errorTemplate = template(fs.readFileSync(__dirname + '/../templates/error.html', 'utf8'));\n/**\n * Summary/Instructions controller\n *\n * @param {HTMLElement} el Summary parent container\n * @param {Object} store A redux store\n * @param {Object} actions Actions an element can dispatch\n * @param {Object} map The mapboxgl instance\n * @private\n */\n\nexport default class Instructions {\n  constructor(el, store, actions, map) {\n    this.container = el;\n    this.actions = actions;\n    this.store = store;\n    this._map = map;\n    this.directions = {};\n    this.render();\n  }\n\n  render() {\n    this.store.subscribe(() => {\n      const _this$actions = this.actions,\n            hoverMarker = _this$actions.hoverMarker,\n            setRouteIndex = _this$actions.setRouteIndex;\n\n      const _this$store$getState = this.store.getState(),\n            routeIndex = _this$store$getState.routeIndex,\n            unit = _this$store$getState.unit,\n            directions = _this$store$getState.directions,\n            error = _this$store$getState.error,\n            compile = _this$store$getState.compile;\n\n      const shouldRender = !isEqual(directions[routeIndex], this.directions);\n\n      if (error) {\n        this.container.innerHTML = errorTemplate({\n          error\n        });\n        return;\n      }\n\n      if (directions.length && shouldRender) {\n        const direction = this.directions = directions[routeIndex];\n\n        if (compile) {\n          direction.legs.forEach(function (leg) {\n            leg.steps.forEach(function (step) {\n              step.maneuver.instruction = compile('en', step);\n            });\n          });\n        }\n\n        this.container.innerHTML = instructionsTemplate({\n          routeIndex,\n          routes: directions.length,\n          steps: direction.legs[0].steps,\n          // Todo: Respect all legs,\n          format: utils.format[unit],\n          duration: utils.format[unit](direction.distance),\n          distance: utils.format.duration(direction.duration)\n        });\n        const steps = this.container.querySelectorAll('.mapbox-directions-step');\n        Array.prototype.forEach.call(steps, el => {\n          const lng = el.getAttribute('data-lng');\n          const lat = el.getAttribute('data-lat');\n          el.addEventListener('mouseover', () => {\n            hoverMarker([lng, lat]);\n          });\n          el.addEventListener('mouseout', () => {\n            hoverMarker(null);\n          });\n          el.addEventListener('click', () => {\n            this._map.flyTo({\n              center: [lng, lat],\n              zoom: 16\n            });\n          });\n        });\n        const routes = this.container.querySelectorAll('input[type=\"radio\"]');\n        Array.prototype.forEach.call(routes, el => {\n          el.addEventListener('change', e => {\n            setRouteIndex(parseInt(e.target.id, 10));\n          });\n        });\n      } else if (this.container.innerHTML && shouldRender) {\n        this.container.innerHTML = '';\n      }\n    });\n  }\n\n}","map":{"version":3,"sources":["/Users/altafquadri/Development/code/Mod5Project/Frontend/lead-us-react/node_modules/@mapbox/mapbox-gl-directions/src/controls/instructions.js"],"names":["utils","template","isEqual","fs","require","instructionsTemplate","readFileSync","__dirname","errorTemplate","Instructions","constructor","el","store","actions","map","container","_map","directions","render","subscribe","hoverMarker","setRouteIndex","getState","routeIndex","unit","error","compile","shouldRender","innerHTML","length","direction","legs","forEach","leg","steps","step","maneuver","instruction","routes","format","duration","distance","querySelectorAll","Array","prototype","call","lng","getAttribute","lat","addEventListener","flyTo","center","zoom","e","parseInt","target","id"],"mappings":"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","sourcesContent":["import utils from '../utils';\nimport template from 'lodash.template';\nimport isEqual from 'lodash.isequal';\n\nlet fs = require('fs'); // substack/brfs#39\nlet instructionsTemplate = template(fs.readFileSync(__dirname + '/../templates/instructions.html', 'utf8'));\nlet errorTemplate = template(fs.readFileSync(__dirname + '/../templates/error.html', 'utf8'));\n\n/**\n * Summary/Instructions controller\n *\n * @param {HTMLElement} el Summary parent container\n * @param {Object} store A redux store\n * @param {Object} actions Actions an element can dispatch\n * @param {Object} map The mapboxgl instance\n * @private\n */\nexport default class Instructions {\n  constructor(el, store, actions, map) {\n    this.container = el;\n    this.actions = actions;\n    this.store = store;\n    this._map = map;\n    this.directions = {};\n    this.render();\n  }\n\n  render() {\n    this.store.subscribe(() => {\n      const { hoverMarker, setRouteIndex } = this.actions;\n      const { routeIndex, unit, directions, error, compile } = this.store.getState();\n      const shouldRender = !isEqual(directions[routeIndex], this.directions);\n\n      if (error) {\n        this.container.innerHTML = errorTemplate({ error });\n        return;\n      }\n\n      if (directions.length && shouldRender) {\n        const direction = this.directions = directions[routeIndex];\n\n        if (compile) {\n          direction.legs.forEach(function(leg) {\n            leg.steps.forEach(function(step) {\n              step.maneuver.instruction = compile('en', step);\n            });\n          });\n        }\n\n        this.container.innerHTML = instructionsTemplate({\n          routeIndex,\n          routes: directions.length,\n          steps: direction.legs[0].steps, // Todo: Respect all legs,\n          format: utils.format[unit],\n          duration: utils.format[unit](direction.distance),\n          distance: utils.format.duration(direction.duration)\n        });\n\n        const steps = this.container.querySelectorAll('.mapbox-directions-step');\n\n        Array.prototype.forEach.call(steps, (el) => {\n          const lng = el.getAttribute('data-lng');\n          const lat = el.getAttribute('data-lat');\n\n          el.addEventListener('mouseover', () => {\n            hoverMarker([lng, lat]);\n          });\n\n          el.addEventListener('mouseout', () => {\n            hoverMarker(null);\n          });\n\n          el.addEventListener('click', () => {\n            this._map.flyTo({\n              center: [lng, lat],\n              zoom: 16\n            });\n          });\n        });\n\n        const routes = this.container.querySelectorAll('input[type=\"radio\"]');\n        Array.prototype.forEach.call(routes, (el) => {\n          el.addEventListener('change', (e) => { setRouteIndex(parseInt(e.target.id, 10)); });\n        });\n      } else if (this.container.innerHTML && shouldRender) {\n        this.container.innerHTML = '';\n      }\n    });\n  }\n}\n"]},"metadata":{},"sourceType":"module"}